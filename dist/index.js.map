{"version":3,"sources":["../src/mod/theme_manager.ts","../src/index.ts"],"names":["ThemeManager","config","storage","Storage","createStore","initialTheme","effect","currentTheme","mediaQuery","handleChange","e","themeName","nextTheme","t","themeManager","getThemeManager","setTheme","toggleTheme","getCurrentTheme","createThemeExtension","ctx"],"mappings":"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","file":"index.js","sourcesContent":["// src/mod/theme_manager.ts\r\n//\r\n// Made with ❤️ by Maysara.\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\r\n\r\n    import { ThemeConfig            } from \"../types\";\r\n    import { createStore, Storage   } from '@minejs/store';\r\n    import { signal, effect         } from '@minejs/signals';\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ CORE ════════════════════════════════════════╗\r\n\r\n    export class ThemeManager {\r\n\r\n        // ┌──────────────────────────────── INIT ──────────────────────────────┐\r\n\r\n            public store: ReturnType<typeof createStore>;\r\n            public signal: ReturnType<typeof signal<string>>;\r\n\r\n            constructor(public config: ThemeConfig) {\r\n\r\n                const storage = new Storage({ type: 'local' });\r\n\r\n                this.store = createStore({\r\n                    state: {\r\n                        theme: config.default\r\n                    },\r\n                    persist: true,\r\n                    storage,\r\n                    storageKey: 'app:theme'\r\n                });\r\n\r\n                this.signal = this.store.state.theme;\r\n\r\n                // Set initial theme on body\r\n                const storedTheme = storage.get('app:theme:theme') as string | null;\r\n                const initialTheme = storedTheme || config.default;\r\n                this.signal.set(initialTheme);\r\n                this.applyTheme(initialTheme);\r\n\r\n                // Setup reactive effect: apply theme whenever signal changes\r\n                effect(() => {\r\n                    const currentTheme = this.signal?.();\r\n                    if (currentTheme) {\r\n                        this.applyTheme(currentTheme);\r\n                    }\r\n\r\n                    console.log(`[ThemeManager] Reactive effect applied theme: ${currentTheme}`);\r\n                });\r\n\r\n                // Listen for system theme changes\r\n                effect(() => {\r\n                    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n\r\n                    const handleChange = (e: MediaQueryListEvent) => {\r\n                        if (!storage.get('app:theme:theme')) this.signal.set(e.matches ? 'dark' : 'light');\r\n                    };\r\n\r\n                    mediaQuery.addEventListener('change', handleChange);\r\n                    return () => mediaQuery.removeEventListener('change', handleChange);\r\n                });\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n\r\n        // ┌──────────────────────────────── MAIN ──────────────────────────────┐\r\n\r\n            getTheme(): string {\r\n                return this.signal?.() ?? this.config.default ?? 'light';\r\n            }\r\n\r\n            setTheme(themeName: string): void {\r\n                if (!this.config.available.includes(themeName)) {\r\n                    console.warn(`[ThemeManager] Unsupported theme: ${themeName}`);\r\n                    return;\r\n                }\r\n\r\n                // Update signal directly - effect will handle DOM updates\r\n                if (this.signal) {\r\n                    this.signal.set(themeName);\r\n                    console.log(`[ThemeManager] Theme set to: ${themeName}`);\r\n                }\r\n            }\r\n\r\n            toggleTheme(): void {\r\n                if (!this.signal) return;\r\n                const currentTheme = this.signal();\r\n                const nextTheme = this.config.available.find(t => t !== currentTheme);\r\n                if (nextTheme) {\r\n                    this.signal.set(nextTheme);\r\n                    console.log(`[ThemeManager] Theme toggled to: ${nextTheme}`);\r\n                }\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n\r\n        // ┌──────────────────────────────── HELP ──────────────────────────────┐\r\n\r\n            private applyTheme(themeName: string): void {\r\n                const htmlEl = document.documentElement || document.rootElement;\r\n                htmlEl.setAttribute('data-theme', themeName);\r\n                console.log(`[ThemeManager] Applied theme: ${themeName}`);\r\n            }\r\n\r\n        // └────────────────────────────────────────────────────────────────────┘\r\n\r\n    };\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n","// src/index.ts\r\n//\r\n// Made with ❤️ by Maysara.\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\r\n\r\n    import { ClientExtension, ExtensionContext  } from \"@cruxjs/base\";\r\n    import { ThemeConfig                        } from \"./types\";\r\n    import { ThemeManager                       } from \"./mod/theme_manager\";\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ MAIN ════════════════════════════════════════╗\r\n\r\n    // Theme manager instance\r\n    let themeManager : ThemeManager;\r\n\r\n    // Exported theme functions\r\n    export const getThemeManager    = () => themeManager;\r\n    export const setTheme           = (themeName: string) => getThemeManager().setTheme(themeName);\r\n    export const toggleTheme        = () => getThemeManager().toggleTheme();\r\n    export const getCurrentTheme    = () => getThemeManager().getTheme();\r\n\r\n    // Theme extension\r\n    export function createThemeExtension(config?: ThemeConfig) : ClientExtension {\r\n        return {\r\n            name : 'ThemeExtension',\r\n\r\n            onBoot: (ctx: ExtensionContext) => {\r\n                // if config provided, merge into client config\r\n                if (config) {\r\n                    ctx.cconfig.theme = {\r\n                        ...ctx.cconfig.theme,\r\n                        ...config\r\n                    };\r\n                }\r\n\r\n                // if no theme config provided, set default\r\n                if (!ctx.cconfig.theme) {\r\n                    ctx.cconfig.theme = {\r\n                        default         : 'dark',\r\n                        available       : ['dark', 'light']\r\n                    };\r\n                }\r\n\r\n                // create theme manager instance\r\n                themeManager    = new ThemeManager({\r\n                    default     : ctx.cconfig.theme!.default,\r\n                    available   : ctx.cconfig.theme!.available\r\n                });\r\n            }\r\n        };\r\n    };\r\n\r\n    // export\r\n    export * from \"./types\";\r\n    export { ThemeManager };\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝"]}